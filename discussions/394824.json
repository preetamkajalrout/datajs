[
  {
    "Id": "909832",
    "ThreadId": "394824",
    "Html": "\r\n<p>I am developing an app in phonegap which get data from OData with datajs and save it to sqlite. datajs works fine, but when I try to save data to sqlite I get the error&nbsp;<strong>&quot; E/Web Console(11533): Uncaught Error: INVALID_STATE_ERR: DOM Exception\r\n 11 at file:///android_asset/www/js/core/Sincronizacion.js:19&quot;. </strong></p>\r\n<p><strong>&nbsp;</strong>Please help me.</p>\r\n<p>This is the code:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">function</span> SincronizarClientes()  <span style=\"color:green\">// This function runs after a button click</span>\n{\n    <span style=\"color:blue\">var</span> db = window.openDatabase(<span style=\"color:#a31515\">&quot;Teyuna&quot;</span>, <span style=\"color:#a31515\">&quot;1.0&quot;</span>, <span style=\"color:#a31515\">&quot;Meteora - Teyuna&quot;</span>, 2000000);\n    db.transaction(ActualizarClientes, FalloSincronizacion, OkSincronizacion);  \n}  \n\n\n<span style=\"color:blue\">function</span> ActualizarClientes(tx)\n{\n\n    OData.read(<span style=\"color:#a31515\">&quot;http://192.168.0.4:30003/TeyunaServices.svc/Clientes?$filter=EQUIPO eq 'T1' and startswith(NOM_UCLIENTE, 'MIGUEL') eq true&quot;</span>,\n        <span style=\"color:blue\">function</span> (data, request) {\n            <span style=\"color:blue\">var</span> html = <span style=\"color:#a31515\">&quot;&quot;</span>, sql = <span style=\"color:#a31515\">&quot;&quot;</span>;\n            <span style=\"color:blue\">for</span> (<span style=\"color:blue\">var</span> i = 0; i &lt; data.results.length; i&#43;&#43;) {\n                html &#43;= <span style=\"color:#a31515\">&quot;&lt;div&gt;&quot;</span> &#43; data.results[i].NOM_UCLIENTE &#43; <span style=\"color:#a31515\">&quot;&lt;/div&gt;&quot;</span>;\n                sql = <span style=\"color:#a31515\">&quot;INSERT OR REPLACE INTO Clientes (Cod_UCliente, Nom_UCliente, Fecha_Actualizacion) VALUES ('&quot;</span> &#43; data.results[i].COD_UCLIENTE &#43; \n                              <span style=\"color:#a31515\">&quot;','&quot;</span> &#43; data.results[i].NOM_UCLIENTE &#43; <span style=\"color:#a31515\">&quot;', datetime())&quot;</span>;\n                <span style=\"color:green\">//sql = &quot;INSERT OR REPLACE INTO Clientes (Cod_UCliente, Nom_UCliente, Fecha_Actualizacion) VALUES ('00012125', 'PEDRO PEREZ PINTO', datetime())&quot;;              </span>\n                tx.executeSql(sql);  <span style=\"color:green\">//This is line 19</span>\n                alert(sql);\n            }\n            document.getElementById(<span style=\"color:#a31515\">&quot;mainContent&quot;</span>).innerHTML = sql;\n            \n            alert(<span style=\"color:#a31515\">&quot;Los clientes se actualizaron correctamente!&quot;</span>);\n        },  <span style=\"color:blue\">function</span>(err) {\n                alert(<span style=\"color:#a31515\">&quot;Error occurred &quot;</span> &#43; err.message);\n            }\n    );   \n}\n\n\n<span style=\"color:green\">// Transaction error callback</span>\n<span style=\"color:green\">//</span>\n<span style=\"color:blue\">function</span> FalloSincronizacion(tx, err) {\n    alert(<span style=\"color:#a31515\">&quot;Error actualizando los clientes: &quot;</span> &#43; err);\n}\n\n<span style=\"color:green\">// Transaction success callback</span>\n<span style=\"color:green\">//</span>\n<span style=\"color:blue\">function</span> OkSincronizacion() {\n    \n}\n</pre>\r\n</div>\r\n",
    "PostedDate": "2012-09-07T16:07:20.867-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "909961",
    "ThreadId": "394824",
    "Html": "\r\n<p>The solution:&nbsp;<a href=\"http://stackoverflow.com/questions/12326336/get-data-from-odata-with-datajs-and-save-to-sqlite-in-phonegap?answertab=votes#tab-top\">http://stackoverflow.com/questions/12326336/get-data-from-odata-with-datajs-and-save-to-sqlite-in-phonegap?answertab=votes#tab-top</a></p>\r\n<p>&quot;OData callback function is run asynchronously, after&nbsp;<code>SincronizarClientes()</code>&nbsp;has returned, so the transaction&nbsp;<code>tx</code>&nbsp;is already closed.</p>\r\n<p>Call&nbsp;<code>db.transaction()</code>&nbsp;inside the callback function instead.&quot;</p>\r\n",
    "PostedDate": "2012-09-08T05:32:25.253-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]