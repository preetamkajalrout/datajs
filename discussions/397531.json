[
  {
    "Id": "920013",
    "ThreadId": "397531",
    "Html": "\r\n<p>Hello,</p>\r\n<p>I use datajs with the SharePoint 2010 odata service. I can successfully insert a new item in a list using Internet Explorer, but using Chrome the response is always HTTP 500, yet the item has been inserted anyway.&nbsp; WTF??? Using Fiddler I can see the\r\n request headers are slightly different between IE and Chrome, but the JSON&nbsp;request body is the same. Here is the IE request:</p>\r\n<pre>POST http://win-9dscbb9bq8k/_vti_bin/listdata.svc/Risks HTTP/1.1\r\nContent-Type: application/json;odata=verbose\r\nAccept-Language: en-gb\r\ndataserviceversion: 1.0\r\nAccept: application/atomsvc&#43;xml;q=0.8, application/json;odata=verbose;q=0.5, */*;q=0.1\r\nmaxdataserviceversion: 2.0\r\nReferer: http://win-9dscbb9bq8k/_Layouts/RiskManagement/Risk.aspx\r\nAccept-Encoding: gzip, deflate\r\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)\r\nHost: win-9dscbb9bq8k\r\nContent-Length: 360\r\nConnection: Keep-Alive\r\nPragma: no-cache\r\nAuthorization: Negotiate oXcwdaADCgEBoloEWE5UTE1TU1AAAwAAAAAAAABYAAAAAAAAAFgAAAAAAAAAWAAAAAAAAABYAAAAAAAAAFgAAAAAAAAAWAAAABXCiOIGAbEdAAAAD36Ifnd&#43;nJo7ac3egkJon4yjEgQQAQAAAPUXp1AtIpqEAAAAAA==\r\n\r\n{&quot;Title&quot;:&quot;bla&quot;,&quot;AssetId&quot;:1,&quot;DepartmentId&quot;:6,&quot;Description&quot;:&quot;&quot;,&quot;AssetManagementPlanValue&quot;:&quot;None&quot;,&quot;RiskMatrixId&quot;:1,&quot;SeverityId&quot;:1,&quot;LikelihoodId&quot;:1,&quot;RatingId&quot;:1,&quot;ColourValue&quot;:&quot;None&quot;,&quot;CurrentMitigationInPlace&quot;:&quot;&quot;,&quot;AdditionalMitigationRequired&quot;:&quot;&quot;,&quot;DecisionRequired&quot;:&quot;&quot;,&quot;AssignedToId&quot;:null,&quot;OwnerId&quot;:null,&quot;StatusValue&quot;:&quot;Open&quot;,&quot;Completed&quot;:null,&quot;DirectionValue&quot;:&quot;New&quot;}</pre>\r\n<p>and here is the Chrome request:</p>\r\n<pre>POST http://win-9dscbb9bq8k/_vti_bin/listdata.svc/Risks HTTP/1.1\r\nHost: win-9dscbb9bq8k\r\nConnection: keep-alive\r\nContent-Length: 360\r\nOrigin: http://win-9dscbb9bq8k\r\nMaxDataServiceVersion: 2.0\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.79 Safari/537.4\r\nContent-Type: application/json;odata=verbose\r\nAccept: application/atomsvc&#43;xml;q=0.8, application/json;odata=verbose;q=0.5, */*;q=0.1\r\nDataServiceVersion: 1.0\r\nReferer: http://win-9dscbb9bq8k/_Layouts/RiskManagement/Risk.aspx\r\nAccept-Encoding: gzip,deflate,sdch\r\nAccept-Language: en-GB,en;q=0.8\r\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3\r\n\r\n{&quot;Title&quot;:&quot;bla&quot;,&quot;AssetId&quot;:1,&quot;DepartmentId&quot;:6,&quot;Description&quot;:&quot;&quot;,&quot;AssetManagementPlanValue&quot;:&quot;None&quot;,&quot;RiskMatrixId&quot;:1,&quot;SeverityId&quot;:1,&quot;LikelihoodId&quot;:1,&quot;RatingId&quot;:1,&quot;ColourValue&quot;:&quot;None&quot;,&quot;CurrentMitigationInPlace&quot;:&quot;&quot;,&quot;AdditionalMitigationRequired&quot;:&quot;&quot;,&quot;DecisionRequired&quot;:&quot;&quot;,&quot;AssignedToId&quot;:null,&quot;OwnerId&quot;:null,&quot;StatusValue&quot;:&quot;Open&quot;,&quot;Completed&quot;:null,&quot;DirectionValue&quot;:&quot;New&quot;}</pre>\r\n<p>This is the response I get using Chrome:</p>\r\n<pre>HTTP/1.1 500 Internal Server Error\r\nCache-Control: no-cache\r\nContent-Type: application/json\r\nServer: Microsoft-IIS/7.5\r\nSPRequestGuid: 502f2cb1-ec9f-49d0-b316-42a2ef6aeed6\r\nX-SharePointHealthScore: 0\r\nDataServiceVersion: 1.0;\r\nX-AspNet-Version: 2.0.50727\r\nX-Powered-By: ASP.NET\r\nMicrosoftSharePointTeamServices: 14.0.0.6120\r\nX-MS-InvokeApp: 1; RequireReadOnly\r\nDate: Mon, 01 Oct 2012 13:14:24 GMT\r\nContent-Length: 2254\r\n\r\n{\r\n&quot;error&quot;: {\r\n&quot;code&quot;: &quot;&quot;, &quot;message&quot;: {\r\n&quot;lang&quot;: &quot;en-GB&quot;, &quot;value&quot;: &quot;An error occurred while processing this request.&quot;\r\n}, &quot;innererror&quot;: {\r\n&quot;message&quot;: &quot;Value does not fall within the expected range.&quot;, &quot;type&quot;: &quot;System.ArgumentException&quot;, &quot;stacktrace&quot;: &quot;   at Microsoft.SharePoint.SPFieldMap.GetColumnNumber(String strFieldName, Boolean bThrow)\\r\\n   at Microsoft.SharePoint.SPListItemCollection.GetColumnNumber(String groupName, Boolean bThrowException)\\r\\n   at Microsoft.SharePoint.SPListItemCollection.GetRawValue(String fieldname, Int32 iIndex, Boolean bThrow)\\r\\n   at Microsoft.SharePoint.SPListItem.GetValue(SPField fld, Int32 columnNumber, Boolean bRaw, Boolean bThrowException)\\r\\n   at Microsoft.SharePoint.SPListItem.GetValue(String strName, Boolean bThrowException)\\r\\n   at Microsoft.SharePoint.SPListItem.get_Item(String fieldName)\\r\\n   at Microsoft.SharePoint.Linq.PropertyMap.GetSPFieldValue(PropertyMap pm, SPListItem item, JoinPath joinPath)\\r\\n   at Microsoft.SharePoint.Linq.PropertyMap.b__3(DataContext dc, SPListItem item, Object entity, JoinPath joinPath)\\r\\n   at Microsoft.SharePoint.Linq.PropertyMap.GetFromListItem(DataContext dc, SPListItem item, Object entity, JoinPath joinPath)\\r\\n   at Microsoft.SharePoint.Linq.EntityRef.RefreshEntityWithListItem()\\r\\n   at Microsoft.SharePoint.Linq.EntityTracker.AddItem(EntityRef eref, ITrackOriginalValues origVals)\\r\\n   at Microsoft.SharePoint.Linq.EntityTracker.SubmitNewEntity(NewEntityRef newEref, Stack`1 visited)\\r\\n   at Microsoft.SharePoint.Linq.EntityTracker.SubmitNewEntities()\\r\\n   at Microsoft.SharePoint.Linq.EntityTracker.SubmitChanges(ConflictMode failureMode, Boolean systemUpdate)\\r\\n   at Microsoft.SharePoint.Linq.DataContext.SubmitChanges(ConflictMode failureMode, Boolean systemUpdate)\\r\\n   at Microsoft.SharePoint.Linq.DataContext.SubmitChanges(ConflictMode failureMode)\\r\\n   at Microsoft.SharePoint.Linq.DataContext.SubmitChanges()\\r\\n   at Microsoft.SharePoint.Linq.DataServiceDataContext.SaveChanges()\\r\\n   at System.Data.Services.UpdatableWrapper.SaveChanges()\\r\\n   at System.Data.Services.DataService`1.HandleNonBatchRequest(RequestDescription description)\\r\\n   at System.Data.Services.DataService`1.HandleRequest()&quot;\r\n}\r\n}\r\n}</pre>\r\n<p>As I said above, despite the error, the new item was successfully inserted into the SharePoint list. Why does IE get a HTTP 201 Created response and why does Chrome get the HTTP 500 Internal server error response?</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2012-10-01T06:20:59.127-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "920698",
    "ThreadId": "397531",
    "Html": "\r\n<p>Hi Remco,</p>\r\n<p>&nbsp;&nbsp; I'm not very knowledgeable of Sharepoint.. so you might want to pursue the root cause of this issue to them.&nbsp; However thi is what I think... I noticed the the request you are sending with Chrome doesn't have Authorization header nor security\r\n token&nbsp;like the one sent from IE.&nbsp; This is causing the Chrome request to be less privileged than the one made from IE (assuming the user logged on in IE would be an admin or some how have some higher privileges).&nbsp;&nbsp; I think you are seeing\r\n the exception becasue of&nbsp;Sharepoint defaults as explained here:</p>\r\n<p><a href=\"http://social.technet.microsoft.com/Forums/en-US/sharepoint2010programming/thread/13e10e5a-acd6-4a9f-a45f-b05b4fd61045\">http://social.technet.microsoft.com/Forums/en-US/sharepoint2010programming/thread/13e10e5a-acd6-4a9f-a45f-b05b4fd61045</a></p>\r\n<p>Regards,</p>\r\n<p>Alex Trigo.</p>\r\n",
    "PostedDate": "2012-10-02T09:57:31.23-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "921106",
    "ThreadId": "397531",
    "Html": "\r\n<p>Hi Alex,</p>\r\n<p>Thank you very much. That solved the problem. My SharePoint list has 10 lookup columns and the default threshold is 8. Very strange that Chrome does not authenticate the same way as IE does. This is not just a problem with odata but also with the normal\r\n web interface of SharePoint. When you browse to the SharePoint list in Chrome SharePoint tells you :</p>\r\n<p>&#65279;&#65279;&#65279;&#65279;This view cannot be displayed because the number of lookup and workflow status columns it contains exceeds the threshold (8) enforced by the administrator.</p>\r\n<p>With IE you get to see the list ok.</p>\r\n<p>I increased the threshold and now it works in Chrome too. It is very strange though to get an error from the odata service&nbsp;when the insert was committed anyway. I ended up with duplicate records as I retried the insert again and again.</p>\r\n<p>thanks for your help</p>\r\n<p>Remco</p>\r\n",
    "PostedDate": "2012-10-03T01:50:54.093-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]